#!/bin/bash

npm run clean
npm run copy
npm dedupe

# compile
spritesmith
stylus client/css/all.styl -o .bin/public/css --include-css --include client/css --compress
cleancss .bin/public/css/all.css -o .bin/public/css/all.css --s0
jade views/**/*.jade -o .bin --client --commonjs --no-debug --obj '{"basedir":"views"}'
taunus -o
browserify client/js/main.js --basedir client/js | uglifyjs > .bin/public/js/all.js

# hashing
reaver .bin/public/{css,js,img}/* --manifest
